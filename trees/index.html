

















<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="CART4.5, ID3 and Random Forest"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



      <meta property="og:title" content="CART4.5, ID3 and Random Forest &middot; Yuhua Cai" />
      <meta property="og:site_name" content="Yuhua Cai" />
      <meta property="og:url" content="https://yc392.github.io/trees/" />
        <script type="text/javascript" async
      src="https://cdn.jsdelivr.net/npm/mathjax@2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$','$$'], ['\[','\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
        TeX: { equationNumbers: { autoNumber: "AMS" },
             extensions: ["AMSmath.js", "AMSsymbols.js"] }
      }
    });
    </script>

    
        
            <meta property="og:image" content="/images/cover1.png"/>
        
    

    
    <meta property="og:description" content="" />
      <meta property="og:type" content="article" />
    <meta property="article:published_time" content="0001-01-01T00:00:00Z" />

    
    

    <title>CART4.5, ID3 and Random Forest &middot; Yuhua Cai</title>

    
    <meta name="description" content="Instructions  If there is a conflict bewteen the problem description in the ipython notebook and the question in the pdf, follow the question in the pdf file. T" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
      <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Yuhua Cai" />
      
      
    
    <meta name="generator" content="Hugo 0.74.3" />

    <link rel="canonical" href="https://yc392.github.io/trees/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null ,
        "logo": "https://yc392.github.ioimages/logo.png"
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "image": {
            "@type": "ImageObject",
            "url": "https://yc392.github.ioimages/logo.png",
            "width": 250,
            "height": 250
        }, 
        
        "url":  null ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "CART4.5, ID3 and Random Forest",
    "name": "CART4.5, ID3 and Random Forest",
    "wordCount":  2096 ,
    "timeRequired": "PT10M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://yc392.github.io/trees/",
    "datePublished": "0001-01-01T00:00Z",
    "dateModified": "0001-01-01T00:00Z",
    
    
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://yc392.github.io/trees/"
    }
}
    </script>
    


    

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/">Home</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/aboutme">About Me</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/adaboost">Adaboost ensembling</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/blogs">Build my personal blog</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/trees">CART4.5, ID3 and Random Forest</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/euler">Euler Project</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/linear_svm">Linear SVM</a>
            </li>
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/malaria">Malaria Data Visualization</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">





<header class="main-header post-head no-cover">
    <nav class="main-nav overlay clearfix">


      
        <a class="blog-logo" href="https://yc392.github.io"><img src="/images/logo.png" alt="Home" /></a>
      
      
          <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
      
    </nav>

    


</header>



<main class="content" role="main">




  <article class="post ">
    <header class="post-header">
      <nav class="breadcrumb">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </nav>


        <h1 class="post-title">CART4.5, ID3 and Random Forest</h1>
        <small></small>

        <section class="post-meta">
        
         
        </section>
    </header>

    <section class="post-content">


<h1 id="instructions">Instructions</h1>
<ol>
<li>If there is a conflict bewteen the problem description in the ipython notebook and the question in the pdf, follow the question in the pdf file.</li>
<li>The part you need to fill in is commented as &ldquo;Code Clip&rdquo;. You can search &ldquo;Code Clip&rdquo; in this notebook to find the part you need to complete. After you finish the required part, you may need to run other related code blocks for evaluation or visualization.</li>
<li>If you have a better implementation or find mistakes in this notebook, you could add/modify any function (input, output and return) yourself. Everything is flexible as long as you answered the questions.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> seaborn <span style="color:#f92672">as</span> sns

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split, cross_val_score, KFold
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> accuracy_score, auc,roc_curve, roc_auc_score
<span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> preprocessing
<span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> metrics
<span style="color:#f92672">from</span> scipy.stats <span style="color:#f92672">import</span> ttest_ind


</code></pre></div><h3 id="load-training-and-testing-data-get-a-initial-statistics-of-the-training-data">Load Training and Testing Data. Get a initial statistics of the training data.</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./data_train.csv&#39;</span>)
test_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./data_test.csv&#39;</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">features_mean <span style="color:#f92672">=</span> list(train_data<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">31</span>])


X_train <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>loc[:,features_mean]
y_train <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;diagnosis&#39;</span>]

X_test <span style="color:#f92672">=</span> test_data<span style="color:#f92672">.</span>loc[:,features_mean]
y_test <span style="color:#f92672">=</span> test_data<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;diagnosis&#39;</span>]

</code></pre></div><h1 id="31-balanced-dataset">3.1 Balanced Dataset</h1>
<h3 id="311-use-5-fold-cross-validation-on-the-training-set-only-and-compare-accuracy-and-time-cost-performance-of-three-different-algorithms--id3-cart-and-random-forest">3.1.1 Use 5-fold cross validation on the training set only, and compare accuracy and time cost performance of three different algorithms:  ID3, CART and Random Forest,</h3>
<p>Code Clip 3.1.1a: Complete the function <code>compare</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> confusion_matrix
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">accuracy_per_class</span>(predict, label):
    cm <span style="color:#f92672">=</span> confusion_matrix(label, predict)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>diag(cm)<span style="color:#f92672">/</span>np<span style="color:#f92672">.</span>sum(cm, axis <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> warnings
warnings<span style="color:#f92672">.</span>filterwarnings(<span style="color:#e6db74">&#34;ignore&#34;</span>, category<span style="color:#f92672">=</span><span style="color:#a6e22e">FutureWarning</span>, module<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sklearn&#34;</span>, lineno<span style="color:#f92672">=</span><span style="color:#ae81ff">1978</span>)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> ExtraTreesClassifier
<span style="color:#f92672">from</span> sklearn.tree <span style="color:#f92672">import</span> DecisionTreeClassifier
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> KFold
<span style="color:#f92672">import</span> time
<span style="color:#f92672">from</span> statistics <span style="color:#f92672">import</span> mean, stdev 
<span style="color:#f92672">from</span> scipy <span style="color:#f92672">import</span> stats
<span style="color:#75715e">#start = time.time()</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">compare</span>(X_train, y_train, X_test, y_test, class_weight <span style="color:#f92672">=</span> None, max_depth <span style="color:#f92672">=</span> None):
    
    <span style="color:#75715e">#accuracy_all = []</span>
    <span style="color:#75715e">#accuracy_per_class_all = []</span>
    <span style="color:#75715e">#cvs_all = []</span>
    accuracy_rf <span style="color:#f92672">=</span> []
    accuracy_cart <span style="color:#f92672">=</span> []
    accuracy_id3 <span style="color:#f92672">=</span> []
    time_rf <span style="color:#f92672">=</span> []
    time_cart <span style="color:#f92672">=</span> []
    time_id3 <span style="color:#f92672">=</span> []
    
    X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>concatenate([X_train, X_test], axis<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
    y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>concatenate([y_train, y_test], axis<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)

    <span style="color:#75715e"># Code Clip 3.1.1a</span>
    <span style="color:#75715e">#-------------Forest-------------</span>
    <span style="color:#75715e"># start = time.time()</span>
    <span style="color:#75715e"># Step 1: Build a random forest and fit the input data.</span>
    <span style="color:#75715e"># Step 2: Do prediction on the testing set.</span>
    <span style="color:#75715e"># end = time.time()</span>
    <span style="color:#75715e"># Step 3: Calculte different metrics: accuracy over testing set, </span>
    <span style="color:#75715e">#             corss validation score over the whole training set,</span>
    <span style="color:#75715e">#             accuracy of each class.</span>
    
    kf <span style="color:#f92672">=</span> KFold(n_splits<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>,shuffle<span style="color:#f92672">=</span>False)
    <span style="color:#75715e">#kf.split(train_data)</span>
    <span style="color:#66d9ef">for</span> train_index, test_index <span style="color:#f92672">in</span> kf<span style="color:#f92672">.</span>split(train_data):
        <span style="color:#75715e"># Split train-test</span>
        X_cv_train, X_cv_test <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>iloc[train_index], X_train<span style="color:#f92672">.</span>iloc[test_index]
        y_cv_train, y_cv_test <span style="color:#f92672">=</span> y_train<span style="color:#f92672">.</span>iloc[train_index], y_train<span style="color:#f92672">.</span>iloc[test_index]
            
        start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        random_forest <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>, criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>)
        random_forest<span style="color:#f92672">.</span>fit(X_cv_train, y_cv_train)
        pred <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>predict(X_cv_test)
        end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        
        time_rf<span style="color:#f92672">.</span>append(end<span style="color:#f92672">-</span>start)
        accuracy_rf<span style="color:#f92672">.</span>append(accuracy_score(y_cv_test,pred))
        <span style="color:#75715e">#accuracy_per_class_all.append(accuracy_per_class(pred, y_cv_test))</span>
        <span style="color:#75715e">#cvs_all.append(cross_val_score(random_forest, X_train, y_train, cv = kf))</span>
        <span style="color:#75715e">#-------------Split by GINI-------------</span>
        start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        cart <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>)
        cart<span style="color:#f92672">.</span>fit(X_cv_train, y_cv_train)
        pred <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(X_cv_test)
        end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        
        time_cart<span style="color:#f92672">.</span>append(end<span style="color:#f92672">-</span>start)
        <span style="color:#75715e">#accuracy_per_class(pred, y_test)</span>
        accuracy_cart<span style="color:#f92672">.</span>append(accuracy_score(y_cv_test,pred))
        <span style="color:#75715e">#accuracy_per_class_all.append(accuracy_per_class(pred, y_cv_test))</span>
        <span style="color:#75715e">#cvs_all.append(cross_val_score(random_forest, X_train, y_train))</span>

        <span style="color:#75715e">#-------------Split by Entropy-------------</span>
        start <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        id3 <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;entropy&#34;</span>)
        id3<span style="color:#f92672">.</span>fit(X_cv_train, y_cv_train)
        pred <span style="color:#f92672">=</span> id3<span style="color:#f92672">.</span>predict(X_cv_test)
        end <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
        <span style="color:#75715e">#accuracy_per_class(pred, y_test)</span>
        
        time_id3<span style="color:#f92672">.</span>append(end<span style="color:#f92672">-</span>start)
        accuracy_id3<span style="color:#f92672">.</span>append(accuracy_score(y_cv_test,pred))
        <span style="color:#75715e">#accuracy_per_class_all.append(accuracy_per_class(pred, y_cv_test))</span>
        <span style="color:#75715e">#cvs_all.append(cross_val_score(random_forest, X_train, y_train))</span>
    
    <span style="color:#66d9ef">return</span> accuracy_rf, accuracy_cart, accuracy_id3, time_rf, time_cart, time_id3
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">accuracy_rf, accuracy_cart, accuracy_id3, time_rf, time_cart, time_id3 <span style="color:#f92672">=</span> compare(X_train, y_train, X_test, y_test)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    avg_acc_rf,avg_acc_cart,avg_acc_id3 <span style="color:#f92672">=</span> mean(accuracy_rf),mean(accuracy_cart),mean(accuracy_id3)
    avg_time_rf,avg_time_cart,avg_time_id3 <span style="color:#f92672">=</span> mean(time_rf),mean(time_cart),mean(time_id3)
    std_acc_rf,std_acc_cart,std_acc_id3 <span style="color:#f92672">=</span> stdev(accuracy_rf),stdev(accuracy_cart),stdev(accuracy_id3)
</code></pre></div><p>Code Clip 3.1.1b: Do pairwise t-tests to determine whether thereâ€™s a significant difference between the best algorithm and the other algorithms. (Hint: You could first use <code>sklearn.model_selection.KFold</code> to get 5 different train/val division on the training set.)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Code Clip 3.1.1b</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stats<span style="color:#f92672">.</span>ttest_rel(accuracy_rf,accuracy_cart)
</code></pre></div><pre><code>Ttest_relResult(statistic=1.6417788607745119, pvalue=0.1759802114476083)
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stats<span style="color:#f92672">.</span>ttest_rel(accuracy_rf,accuracy_id3)
</code></pre></div><pre><code>Ttest_relResult(statistic=1.1876701108169152, pvalue=0.3006678235482861)
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stats<span style="color:#f92672">.</span>ttest_rel(accuracy_id3,accuracy_cart)
</code></pre></div><pre><code>Ttest_relResult(statistic=1.5136732103419446, pvalue=0.20466711250685823)
</code></pre>
<h3 id="312-effect-of-the-depth">3.1.2 Effect of the depth.</h3>
<p>Code Clip 3.1.2: Complete the function <code>run_cross_validation_on_trees</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run_cross_validation_on_trees</span>(X, y, tree_depths, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, scoring<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;accuracy&#39;</span>):
<span style="color:#75715e">#     cv_scores_list = []</span>
<span style="color:#75715e">#     cv_scores_std = []</span>
<span style="color:#75715e">#     cv_scores_mean = []</span>
     accuracy_scores <span style="color:#f92672">=</span> []
    
<span style="color:#75715e">#     for depth in tree_depths:</span>
        <span style="color:#75715e"># Get the accuracy,  mean, std of the cross validation score.</span>
    
     <span style="color:#66d9ef">for</span> depth <span style="color:#f92672">in</span> tree_depths:
        accuracy_rf <span style="color:#f92672">=</span> []
        kf <span style="color:#f92672">=</span> KFold(n_splits<span style="color:#f92672">=</span>cv,shuffle<span style="color:#f92672">=</span>False)
        <span style="color:#75715e">#kf.split(train_data)</span>
        <span style="color:#66d9ef">for</span> train_index, test_index <span style="color:#f92672">in</span> kf<span style="color:#f92672">.</span>split(train_data):
            <span style="color:#75715e"># Split train-test</span>
            X_cv_train, X_cv_test <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>iloc[train_index], X_train<span style="color:#f92672">.</span>iloc[test_index]
            y_cv_train, y_cv_test <span style="color:#f92672">=</span> y_train<span style="color:#f92672">.</span>iloc[train_index], y_train<span style="color:#f92672">.</span>iloc[test_index]
            
            random_forest <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>,max_depth <span style="color:#f92672">=</span> depth,min_samples_split<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
            random_forest<span style="color:#f92672">.</span>fit(X_cv_train, y_cv_train)
            pred <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>predict(X_cv_test)

            accuracy_rf<span style="color:#f92672">.</span>append(accuracy_score(y_cv_test,pred))
        
        accuracy_scores<span style="color:#f92672">.</span>append(mean(accuracy_rf))
    <span style="color:#75715e"># return what you need</span>
<span style="color:#75715e">#     return cv_scores_mean, cv_scores_std, accuracy_scores</span>
     <span style="color:#66d9ef">return</span> accuracy_scores

<span style="color:#75715e"># function for plotting cross-validation results</span>
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_cross_validation_on_trees</span>(depths, accuracy_scores, title):
    fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">5</span>))
    <span style="color:#75715e">#ax.plot(depths, cv_scores_mean, &#39;-o&#39;, label=&#39;mean cross-validation accuracy&#39;, alpha=0.9)</span>
    <span style="color:#75715e">#ax.fill_between(depths, cv_scores_mean-2*cv_scores_std, cv_scores_mean+2*cv_scores_std, alpha=0.2)</span>
    <span style="color:#75715e">#ylim = plt.ylim()</span>
    ax<span style="color:#f92672">.</span>plot(depths, accuracy_scores, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;train accuracy&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
    ax<span style="color:#f92672">.</span>set_title(title, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
    ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Tree depth&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
    ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
    ax<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
    ax<span style="color:#f92672">.</span>set_xticks(depths)
    ax<span style="color:#f92672">.</span>legend()

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sm_tree_depths <span style="color:#f92672">=</span> range(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>)
<span style="color:#75715e"># get what you returned.</span>
sm_accuracy_scores <span style="color:#f92672">=</span> run_cross_validation_on_trees(X_train, y_train, sm_tree_depths)
<span style="color:#66d9ef">print</span>(sm_accuracy_scores)


<span style="color:#75715e"># plotting accuracy</span>
plot_cross_validation_on_trees(sm_tree_depths, sm_accuracy_scores, 
                               <span style="color:#e6db74">&#39;Accuracy per decision tree depth on training data&#39;</span>)
plt<span style="color:#f92672">.</span>show()

<span style="color:#75715e"># Play: Only uses the first ten features.</span>
<span style="color:#75715e"># sm_cv_scores_mean2, sm_cv_scores_std2, sm_accuracy_scores2 = run_cross_validation_on_trees(X_train.iloc[:,:10],</span>
<span style="color:#75715e">#                                                                                         y_train, sm_tree_depths)</span>

<span style="color:#75715e"># # plotting accuracy</span>
<span style="color:#75715e"># plot_cross_validation_on_trees(sm_tree_depths, sm_cv_scores_mean2, sm_cv_scores_std2, sm_accuracy_scores2, </span>
<span style="color:#75715e">#                                &#39;Accuracy per decision tree depth on training data&#39;)</span>
<span style="color:#75715e"># plt.show()</span>
</code></pre></div><pre><code>[0.9590366581415175, 0.964919011082694, 0.964919011082694, 0.9707587382779199, 0.9678175618073316, 0.9648763853367434, 0.9648763853367434, 0.9648763853367434, 0.9648763853367434, 0.9648763853367434]
</code></pre>
<p><img src="/images/output_19_1.png" alt="png"></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">random_forest <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>,max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>,min_samples_split<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,random_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>)
pred <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>fit(X_train, y_train)<span style="color:#f92672">.</span>predict(X_test)
accuracy <span style="color:#f92672">=</span> accuracy_score(y_test,pred)
accuracy
</code></pre></div><pre><code>0.9534883720930233
</code></pre>
<h3 id="313-roc-and-vairable-importance">3.1.3 ROC and vairable importance</h3>
<p>Code Clip 3.1.3a: Complete the function <code>draw_roc_with_feature_idx</code>. Then finished the next two steps (<code>AUC of different features</code> and <code>Draw ROC Curve of the first five features</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_roc</span>(fpr, tpr, roc_auc, title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>):
    plt<span style="color:#f92672">.</span>figure()
    lw <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
    plt<span style="color:#f92672">.</span>plot(fpr, tpr, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;darkorange&#39;</span>,
             lw<span style="color:#f92672">=</span>lw, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ROC curve (area ={})&#39;</span><span style="color:#f92672">.</span>format(roc_auc))
    plt<span style="color:#f92672">.</span>plot([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;navy&#39;</span>, lw<span style="color:#f92672">=</span>lw, linestyle<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--&#39;</span>)
    plt<span style="color:#f92672">.</span>xlim([<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.0</span>])
    plt<span style="color:#f92672">.</span>ylim([<span style="color:#ae81ff">0.0</span>, <span style="color:#ae81ff">1.05</span>])
    plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>)
    plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>)
    plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Receiver operating characteristic over {}&#39;</span><span style="color:#f92672">.</span>format(title))
    plt<span style="color:#f92672">.</span>legend(loc<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lower right&#34;</span>)
    plt<span style="color:#f92672">.</span>show()
    


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">draw_roc_with_feature_idx</span>(X_test, y_test, i, draw <span style="color:#f92672">=</span> False):
    
    <span style="color:#75715e"># Code Clip 3.1.3</span>
    <span style="color:#75715e"># calculate list of false positive rate and true positive rate.</span>
    <span style="color:#75715e"># calculate AUC.</span>
    
    <span style="color:#75715e">#if draw:</span>
    <span style="color:#75715e">#    plot_roc(fpr, tpr, roc_auc, title = &#39;Feature&#39; + str(i))</span>
        
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span><span style="color:#75715e">#auc</span>
    

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fpr_all <span style="color:#f92672">=</span> []
tpr_all <span style="color:#f92672">=</span> []
AUC_all <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">30</span>):
    y_score <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>iloc[:,i]<span style="color:#f92672">.</span>copy()
    fpr, tpr, thresholds <span style="color:#f92672">=</span> roc_curve(y_train, y_score)
    fpr_all<span style="color:#f92672">.</span>append(fpr)
    tpr_all<span style="color:#f92672">.</span>append(tpr)
    AUC_all<span style="color:#f92672">.</span>append(auc(fpr, tpr))
    
fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span>),constrained_layout<span style="color:#f92672">=</span>True)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>):
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>):
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">20</span>):
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">25</span>):
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">30</span>):
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()

</code></pre></div><pre><code>&lt;matplotlib.legend.Legend at 0x7fe66a2b4190&gt;
</code></pre>
<p><img src="/images/output_23_1.png" alt="png"></p>
<h4 id="do-you-think-some-features-might-be-more-useful-than-others">Do you think some features might be more useful than others?</h4>
<p>Ans: Some features like feature 8,21,23,24,28 might be more useful than others because their AUC are larger than others.</p>
<h3 id="auc-of-different-features">AUC of different features</h3>
<p>Code clip 3.1.3b,
You may find plt.bar useful here.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">15</span>))

name_list <span style="color:#f92672">=</span> []
<span style="color:#75715e"># Code Clip 3.1.3b</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">30</span>):
    name_list<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#34;Feature &#34;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))


plt<span style="color:#f92672">.</span>barh(range(len(AUC_all)), AUC_all,color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;b&#39;</span>,tick_label<span style="color:#f92672">=</span>name_list)
plt<span style="color:#f92672">.</span>show()
<span style="color:#75715e">#plt.xlabel(&#39;Feature Number&#39;)</span>
<span style="color:#75715e">#plt.ylabel(&#39;AUC&#39;)</span>
<span style="color:#75715e">#plt.title(&#39;AUC of different features&#39;)</span>
<span style="color:#75715e">#plt.legend(loc=&#34;lower right&#34;)</span>
<span style="color:#75715e">#plt.show()</span>



</code></pre></div><p><img src="/images/output_26_0.png" alt="png"></p>
<h3 id="draw-roc-curve-of-the-first-five-features">Draw ROC Curve of the first five features</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">5</span>))
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
        ax<span style="color:#f92672">.</span>plot(fpr_all[i],tpr_all[i], <span style="color:#e6db74">&#39;--&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Feature&#39;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
        ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;False Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
        ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;True Positive Rate&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax<span style="color:#f92672">.</span>legend()
</code></pre></div><pre><code>&lt;matplotlib.legend.Legend at 0x7fe667856ed0&gt;
</code></pre>
<p><img src="/images/output_28_1.png" alt="png"></p>
<h3 id="314-partial-roc">3.1.4 Partial ROC</h3>
<p>Code Clip 3.1.4 Follow the intruction in the question. You could test the correctness of your code by setting $t_0 = 0, t_1= 1$.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Code Clip 3.1.4</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
    feature <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(X_train<span style="color:#f92672">.</span>iloc[:,i])
    partial_roc_auc <span style="color:#f92672">=</span> roc_auc_score(y_train,feature,max_fpr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.2</span>)
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Feature &#34;</span><span style="color:#f92672">+</span> str(i) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&#39;s partial auc: &#34;</span> <span style="color:#f92672">+</span>str(partial_roc_auc))
</code></pre></div><pre><code>Feature 0's partial auc: 0.8642425582080755
Feature 1's partial auc: 0.5964117300324197
Feature 2's partial auc: 0.8800839964633068
Feature 3's partial auc: 0.8669134983790157
Feature 4's partial auc: 0.6059902740937224
</code></pre>
<h3 id="315-model-reliance-of-cart-model">3.1.5 Model Reliance of CART model</h3>
<p>Code Clip 3.1.5 Follow the instruction in the question.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Code Clip 3.1.5</span>
cart <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>)
cart<span style="color:#f92672">.</span>fit(X_train, y_train)
pred <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(X_train)
accuracy_CART <span style="color:#f92672">=</span> accuracy_score(y_train,pred)
<span style="color:#75715e">#print(accuracy_CART)</span>
<span style="color:#75715e">#print(X_train)</span>
<span style="color:#75715e">#type(X_train)</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(X_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]):
    copy <span style="color:#f92672">=</span> X_train<span style="color:#f92672">.</span>copy()
    copy<span style="color:#f92672">.</span>iloc[:,i] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>permutation(copy<span style="color:#f92672">.</span>iloc[:,i]<span style="color:#f92672">.</span>values)
    <span style="color:#75715e">#print(copy)</span>
    pred_scramble <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(copy)
    accuracy_feature <span style="color:#f92672">=</span> accuracy_score(y_train,pred_scramble)
    <span style="color:#75715e">#print(accuracy_feature)</span>
    loss <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span><span style="color:#f92672">*</span>(accuracy_CART<span style="color:#f92672">-</span>accuracy_feature)<span style="color:#f92672">/</span>accuracy_CART
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Feature &#34;</span><span style="color:#f92672">+</span>str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; gets loss: &#34;</span><span style="color:#f92672">+</span>(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> loss)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;%&#39;</span>)
</code></pre></div><pre><code>Feature 1 gets loss: 4.094%
Feature 2 gets loss: 0.000%
Feature 3 gets loss: 0.000%
Feature 4 gets loss: 0.000%
Feature 5 gets loss: 0.000%
Feature 6 gets loss: 0.000%
Feature 7 gets loss: 0.000%
Feature 8 gets loss: 0.000%
Feature 9 gets loss: 0.000%
Feature 10 gets loss: 0.000%
Feature 11 gets loss: 0.000%
Feature 12 gets loss: 0.000%
Feature 13 gets loss: 0.000%
Feature 14 gets loss: 0.000%
Feature 15 gets loss: 0.585%
Feature 16 gets loss: 0.000%
Feature 17 gets loss: 1.462%
Feature 18 gets loss: 0.000%
Feature 19 gets loss: 0.000%
Feature 20 gets loss: 0.877%
Feature 21 gets loss: 14.620%
Feature 22 gets loss: 0.000%
Feature 23 gets loss: 3.216%
Feature 24 gets loss: 0.000%
Feature 25 gets loss: 0.000%
Feature 26 gets loss: 0.000%
Feature 27 gets loss: 0.000%
Feature 28 gets loss: 19.591%
Feature 29 gets loss: 0.000%
Feature 30 gets loss: 0.000%
</code></pre>
<h1 id="32-imbalanced-dataset">3.2 Imbalanced Dataset</h1>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./data_imbalanced_train.csv&#39;</span>)
test_data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;./data_imbalanced_test.csv&#39;</span>)

features_mean <span style="color:#f92672">=</span> list(train_data<span style="color:#f92672">.</span>columns[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">31</span>])

X_train <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>loc[:,features_mean]
y_train <span style="color:#f92672">=</span> train_data<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;diagnosis&#39;</span>]

X_test <span style="color:#f92672">=</span> test_data<span style="color:#f92672">.</span>loc[:,features_mean]
y_test <span style="color:#f92672">=</span> test_data<span style="color:#f92672">.</span>loc[:, <span style="color:#e6db74">&#39;diagnosis&#39;</span>]


</code></pre></div><h3 id="321-what-is-the-ratio-between-the-two-labels-">3.2.1ï¼š What is the ratio between the two labels ?</h3>
<p>Code Clip 3.2.1</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Code Clip 3.2.1</span>

positive <span style="color:#f92672">=</span> len([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> y_train <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span><span style="color:#ae81ff">1</span>])
negative <span style="color:#f92672">=</span> len([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> y_train <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span><span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">if</span> positive<span style="color:#f92672">&gt;</span>negative:
    imbalance_ratio <span style="color:#f92672">=</span> negative<span style="color:#f92672">/</span>positive
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Class 0 is less common class.&#34;</span>)
<span style="color:#66d9ef">else</span>:
    imbalance_ratio <span style="color:#f92672">=</span> positive<span style="color:#f92672">/</span>negative
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Class 1 is less common class.&#34;</span>)
    
imbalance_ratio
</code></pre></div><pre><code>Class 1 is less common class.





0.1793103448275862
</code></pre>
<h3 id="322-use-three-algorithms--from--problem--31--to--train--models--on--the--training--set---please--report--the-confusion-matrix-on-the-test-set">3.2.2 Use three algorithms  from  Problem  3.1  to  train  models  on  the  training  set.   Please  report  the confusion matrix on the test set.</h3>
<p>Code Clip 3.2.2</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Code Clip 3.2.2</span>

random_forest <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>, criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>)
pred_rf <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>fit(X_train, y_train)<span style="color:#f92672">.</span>predict(X_test)
cm_rf <span style="color:#f92672">=</span> confusion_matrix(y_test,pred_rf)

cart <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>)
cart<span style="color:#f92672">.</span>fit(X_train, y_train)
pred_cart <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(X_test)
cm_cart <span style="color:#f92672">=</span> confusion_matrix(y_test,pred_cart)

id3 <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;entropy&#34;</span>)
id3<span style="color:#f92672">.</span>fit(X_train, y_train)
pred_id3 <span style="color:#f92672">=</span> id3<span style="color:#f92672">.</span>predict(X_test)
cm_id3 <span style="color:#f92672">=</span> confusion_matrix(y_test,pred_id3)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cm_rf, cm_cart, cm_id3
</code></pre></div><pre><code>(array([[66,  1],
        [ 2, 17]]), array([[63,  4],
        [ 4, 15]]), array([[65,  2],
        [ 2, 17]]))
</code></pre>
<h3 id="323-for-each-class-get-the-accuracy-on-the-training-set-and-testing-set-with-different-sample-reweighting-parameters-plot-them-according-to-the-reweight-parameter-set-the-maximum-depth-of-all-the-algorithms-to-3">3.2.3 For each class, get the accuracy on the training set and testing set with different sample reweighting parameters. Plot them according to the reweight parameter. (Set the maximum depth of all the algorithms to 3).</h3>
<p>Code Clip 3.2.3:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">weight_list <span style="color:#f92672">=</span> list(np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">21</span>))

rf_acc_train <span style="color:#f92672">=</span> []
rf_acc_test <span style="color:#f92672">=</span> []
cart_acc_train <span style="color:#f92672">=</span> []
cart_acc_test <span style="color:#f92672">=</span> []
id3_acc_train <span style="color:#f92672">=</span> []
id3_acc_test <span style="color:#f92672">=</span> []

<span style="color:#66d9ef">for</span> weight <span style="color:#f92672">in</span> weight_list:
    <span style="color:#75715e"># Code Clip 3.2.3</span>
    <span style="color:#75715e"># Calculte the accuracy of each class.</span>
    class_weight <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">1.</span>,
                <span style="color:#ae81ff">1</span>: weight}
    
    
    random_forest <span style="color:#f92672">=</span> RandomForestClassifier(n_estimators <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>, max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>, class_weight<span style="color:#f92672">=</span>class_weight)
    random_forest<span style="color:#f92672">.</span>fit(X_train, y_train)
    pred_rf_train <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>predict(X_train)
    pred_rf_test <span style="color:#f92672">=</span> random_forest<span style="color:#f92672">.</span>predict(X_test)
    rf_acc_train<span style="color:#f92672">.</span>append(accuracy_per_class(pred_rf_train, y_train))
    rf_acc_test<span style="color:#f92672">.</span>append(accuracy_per_class(pred_rf_test, y_test))
    
    cart <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;gini&#34;</span>, max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, class_weight <span style="color:#f92672">=</span> class_weight)
    cart<span style="color:#f92672">.</span>fit(X_train, y_train)
    pred_cart_train <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(X_train)
    pred_cart_test <span style="color:#f92672">=</span> cart<span style="color:#f92672">.</span>predict(X_test)
    cart_acc_train<span style="color:#f92672">.</span>append(accuracy_per_class(pred_cart_train, y_train))
    cart_acc_test<span style="color:#f92672">.</span>append(accuracy_per_class(pred_cart_test, y_test))
    
    id3 <span style="color:#f92672">=</span> DecisionTreeClassifier(criterion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;entropy&#34;</span>, max_depth <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>, class_weight<span style="color:#f92672">=</span>class_weight)
    id3<span style="color:#f92672">.</span>fit(X_train, y_train)
    pred_id3_train <span style="color:#f92672">=</span> id3<span style="color:#f92672">.</span>predict(X_train)
    pred_id3_test <span style="color:#f92672">=</span> id3<span style="color:#f92672">.</span>predict(X_test)
    id3_acc_train<span style="color:#f92672">.</span>append(accuracy_per_class(pred_id3_train, y_train))
    id3_acc_test<span style="color:#f92672">.</span>append(accuracy_per_class(pred_id3_test, y_test))



</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cart_acc_train
</code></pre></div><pre><code>[array([1.        , 0.88461538]),
 array([0.98965517, 0.96153846]),
 array([0.97931034, 0.98076923]),
 array([0.9862069 , 0.96153846]),
 array([0.95172414, 1.        ]),
 array([0.95172414, 1.        ]),
 array([0.95172414, 1.        ]),
 array([0.95172414, 1.        ]),
 array([0.95172414, 1.        ]),
 array([0.95172414, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ]),
 array([0.93448276, 1.        ])]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">[each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> cart_acc_train]
</code></pre></div><pre><code>[1.0,
 0.9896551724137931,
 0.9793103448275862,
 0.9862068965517241,
 0.9517241379310345,
 0.9517241379310345,
 0.9517241379310345,
 0.9517241379310345,
 0.9517241379310345,
 0.9517241379310345,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896,
 0.9344827586206896]
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span>), constrained_layout<span style="color:#f92672">=</span>True)
<span style="color:#75715e">#ax.plot(depths, cv_scores_mean, &#39;-o&#39;, label=&#39;mean cross-validation accuracy&#39;, alpha=0.9)</span>
<span style="color:#75715e">#ax.fill_between(depths, cv_scores_mean-2*cv_scores_std, cv_scores_mean+2*cv_scores_std, alpha=0.2)</span>
<span style="color:#75715e">#ylim = plt.ylim()</span>
rf_acc_train_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> rf_acc_train]
rf_acc_train_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> rf_acc_train]
rf_acc_test_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> rf_acc_test]
rf_acc_test_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> rf_acc_test]

cart_acc_train_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> cart_acc_train]
cart_acc_train_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> cart_acc_train]
cart_acc_test_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> cart_acc_test]
cart_acc_test_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> cart_acc_test]

id3_acc_train_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> id3_acc_train]
id3_acc_train_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> id3_acc_train]
id3_acc_test_class0 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> id3_acc_test]
id3_acc_test_class1 <span style="color:#f92672">=</span> [each[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> each <span style="color:#f92672">in</span> id3_acc_test]

ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, rf_acc_train_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, rf_acc_train_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Random forest accuracy on training set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()

ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, rf_acc_test_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, rf_acc_test_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Random forest accuracy on test set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()

ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, cart_acc_train_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, cart_acc_train_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;CART accuracy on training set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()

ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, cart_acc_test_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, cart_acc_test_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;CART accuracy on test set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()

ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, id3_acc_train_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>plot(weight_list, id3_acc_train_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;ID3 accuracy on training set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>legend()

ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, id3_acc_test_class0, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class0&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>plot(weight_list, id3_acc_test_class1, <span style="color:#e6db74">&#39;-*&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;class1&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.9</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;ID3 accuracy on test set&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">16</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;Weight&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;Accuracy&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">14</span>)
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>set_ylim([<span style="color:#ae81ff">0.8</span>,<span style="color:#ae81ff">1</span>])
ax[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>legend()

plt<span style="color:#f92672">.</span>show()
</code></pre></div><p><img src="/images/output_44_0.png" alt="png"></p>









    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://yc392.github.io" style="background-image: url(/images/logo.png)"><span class="hidden">Yuhua Cai's Picture</span></a>
    </figure>
    

    








<figure class="author-image">
    <a class="img" href="https://yc392.github.io" style="background-image: url(/images/logo.png)"><span class="hidden">Yuhua Cai's Picture</span></a>
</figure>


<section class="author">
  <h4><a href="https://yc392.github.io">Yuhua Cai</a></h4>
  
  <p>Read <a href="https://yc392.github.io">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Durham, NC, USA</span>
    
  </div>
</section>




    
<section class="share">
  <h4>Share this page</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=CART4.5%2c%20ID3%20and%20Random%20Forest&nbsp;-&nbsp;Yuhua%20Cai&amp;url=https%3a%2f%2fyc392.github.io%2ftrees%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fyc392.github.io%2ftrees%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fyc392.github.io%2ftrees%2f&amp;description=CART4.5%2c%20ID3%20and%20Random%20Forest"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fyc392.github.io%2ftrees%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>

<aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/adaboost/">
          <section class="post">
              <h2>Adaboost Ensembling</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/linear_svm/">
          <section class="post">
              <h2>Support Vector Machine</h2>
          </section>
      </a>
  
</aside>


    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Yuhua Cai</a> Â© Yuhua Cai Duke 2021</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

